To add piwik (statistics access for openaire)

In the footer add the following code:

      <%@ page import="org.dspace.core.ConfigurationManager" %>
      <%@ page import="org.dspace.content.Item" %>

      <%

      String piwikID = ConfigurationManager.getProperty("piwik.id");
      String baseUrl = ConfigurationManager.getProperty("dspace.hostname");
      String handle;


      try{
      Item item = (Item) request.getAttribute("item");

      // get the handle if the item has one yet
      handle = item.getHandle();
      }
      catch(Exception e){
      	handle = null;
      	//e.printstacktrace();
      }

      %>

      <!-- Piwik -->
      <script type="text/javascript">
        var _paq = _paq || [];
        _paq.push(['trackPageView']);
        _paq.push(['enableLinkTracking']);
        (function() {
          var u="//analytics.openaire.eu/";
          _paq.push(['setTrackerUrl', u+'piwik.php']);
          _paq.push(['setSiteId', <%=piwikID%>]);
          <% if(handle != null){%>
          	_paq.push(['setCustomVariable', 1, 'oaipmhID',"oai:<%= baseUrl %>/<%=handle %>", 'page']);
          <%}%>
          var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
          g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'piwik.js'; s.parentNode.insertBefore(g,s);
        })();
      </script>
      <noscript><p><img src="//analytics.openaire.eu/piwik.php?idsite=<%=piwikID%>" style="border:0;" alt="" /></p></noscript>


And in the build.properties have to be defined piwik.id with the piwik of the institution.
 

DSpace version information can be viewed online at
 - https://wiki.duraspace.org/display/DSDOC/

Documentation for the most recent stable release(s) may be downloaded
or viewed online at
 - http://www.dspace.org/latest-release/
 - https://wiki.duraspace.org/display/DSDOC/
 - http://sourceforge.net/projects/dspace/files/DSpace%20Stable/
     (select a version and read DSpace-Manual.pdf)

Installation instructions are to be found in that documentation.

In addition, a listing of all known contributors to DSpace software can be
found online at:
https://wiki.duraspace.org/display/DSPACE/DSpaceContributors

Installation instructions for other versions may be different, so you
are encouraged to obtain the appropriate version of the Documentation
from the links above.

To obtain files from the repository and build, please see:

 - https://github.com/DSpace/DSpace/

or just:

 - git clone git://github.com/DSpace/DSpace.git

Please refer any further problems to the dspace-tech@lists.sourceforge.net
mailing list.

 - http://sourceforge.net/mail/?group_id=19984


Detailed Issue Tracking for DSpace is done on our JIRA Issue Tracker

 - https://jira.duraspace.org/browse/DS


To contribute to DSpace, please see:

 - https://wiki.duraspace.org/display/DSPACE/How+to+Contribute+to+DSpace


For more details about DSpace, including a list of service providers,
places to seek help, news articles and lists of other users, please see:

 - http://www.dspace.org/


DSpace source code licensing information available online at:
 - http://www.dspace.org/license/

Copyright (c) 2002-2015, DuraSpace.  All rights reserved.
